%%%==============================================================================
% WinEdt pragmas
% !Mode:: "TeX:EN"
% Default Compile engines:
% !TEX program = pdflatex
% !PDFTeXify ext =  --enable-etex  --restrict-write18
% !PDFLaTeX ext  =  --enable-etex  --restrict-write18
% !BIB program = none
%%%==============================================================================
%% Copyright 2025-present by Alceu Frigeri
%%
%% This work may be distributed and/or modified under the conditions of
%%
%% * The [LaTeX Project Public License](http://www.latex-project.org/lppl.txt),
%%   version 1.3c (or later), and/or
%% * The [GNU Affero General Public License](https://www.gnu.org/licenses/agpl-3.0.html),
%%   version 3 (or later)
%%
%% This work has the LPPL maintenance status *maintained*.
%%
%% The Current Maintainer of this work is Alceu Frigeri
%%
%% This is version {1.0} {2025/10/19}
%%
%% The list of files that compose this work can be found in the README.md file at
%% https://ctan.org/pkg/pkginfo
%%
%%%==============================================================================
\documentclass[10pt]{article}
\RequirePackage[verbose,a4paper,marginparwidth=27.5mm,top=2.5cm,bottom=1.5cm,hmargin={40mm,20mm},marginparsep=2.5mm,columnsep=10mm,asymmetric]{geometry}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{codedescribe}
\RequirePackage[inline]{enumitem}
\SetEnumitemKey{miditemsep}{parsep=0ex,itemsep=0.4ex}

\usepackage{pkginfo}

%% if needed
%\RequirePackage[backend=biber]{biblatex}
%\addbibresource{pkginfo.bib}

\RequirePackage[hidelinks,hypertexnames=false]{hyperref}

\begin{document}
\tstitle{
  author={Alceu Frigeri\footnote{\tsverb{https://github.com/alceu-frigeri/pkginfo}}},
  date={\tsdate},
  title={The pkginfo Package\break Version \PkgInfo{pkginfo}{version}}
  }
  
%\PkgDescription{pkginfo}

\begin{typesetabstract}

This package is aimed at package writers and offers a way to collect/document \LaTeX\ package's info (name, version, description, etc.) in a systemized way, including a mechanism to check package's version. Just a few functions are defined, to document/set package's info, retrieve them and to verify package's version (for instance, to verify if a loaded package is newer than a given reference).

\end{typesetabstract}

%\tableofcontents



\setnewcodekey{pkginfo}{codeprefix={},resultprefix={},letter={@,_},
  keywd2={
    pkginfo_set,pkginfo_get,pkginfo_required,
    PkgSet,PkgInfo,PkgDescription,PkgRequired
    },
  emph2={name,prefix,version,date,description}
  }



\section{Expl3 Commands}\label{expl3-cmds}


\begin{codedescribe}{\pkginfo_set:nn}
\begin{codesyntax}%
\tsmacro{\pkginfo_set:nn}{pack-name,keyval-list}
\end{codesyntax}
This will create a property list associated with \tsobj[marg]{pack-name}. \tsobj[marg]{keyval-list} might contain any set of keys, though, the functions below expect at least \tsobj[meta]{version} (for version checking) and \tsobj[meta]{name,version,date,description} (for \tsobj{\PkgDescription}).
\end{codedescribe}
\begin{tsremark}
  An error will be raised if calling it twice for the same \tsobj[marg]{pack-name}.
\end{tsremark}
For Example:
\begin{codestore}[demoA]
\pkginfo_set:nn {pkginfo}
  { 
    name         = {pkginfo} ,
    prefix       = {pkginfo} ,
    date         = {2025/10/19},
    version      = {1.0} ,
    description  = {Collecting~ package's~ info~ in~ a~ regular~ way}
  }
\end{codestore}

\tscode*[pkginfo]{demoA}

\begin{codedescribe}[code,EXP]{\pkginfo_get:nn}
\begin{codesyntax}%
\tsmacro{\pkginfo_get:nn}{pack-name,key}
\end{codesyntax}
This will retrieve \tsobj[marg]{key}'s value. If \tsobj[marg,sep=or]{pack-name,key} doesn't exist, this will expands to nothing.
\end{codedescribe}

\begin{codedescribe}{\pkginfo_get:nnN}
\begin{codesyntax}%
\tsmacro{\pkginfo_get:nnN}{pack-name,key,tl-var}
\end{codesyntax}
This will store \tsobj[marg]{key}'s value at \tsobj[marg]{tl-var}. If \tsobj[marg,sep=or]{pack-name,key} doesn't exist, \tsobj[marg]{tl-var} will be cleared.
\end{codedescribe}

\begin{codedescribe}{\pkginfo_required:nnn}
\begin{codesyntax}%
\tsmacro{\pkginfo_required:nnn}{your-pack,pack-name,min-version}
\end{codesyntax}
These will verify if \tsobj[marg]{pack-name}'s \tsobj[marg]{version} (as stored with \tsobj{\pkginfo_set:nn}) is at least \tsobj[marg]{min-version}. It expects \tsobj[marg]{version} in one of three formats \tsobj[keys,sep=or]{[v]digits[letters],[v]digits.digits[letters],[v]digits.digits.digits[letters]} (the \tsobj[key]{[v]}, if present, is ignored).
\end{codedescribe}
\begin{tsremark}
  An error will be raised if \tsobj{pack-name}'s info isn't defined, incorrect version format or \tsobj[marg]{min-version} isn't satisfied, in which case the error will note that \tsobj{your-pack} needs version \tsobj[marg]{min-version} of \tsobj[marg]{pack-name}.
\end{tsremark}


\section{LaTeX2e Commands}\label{2e-cmds}

\begin{codedescribe}{\PkgSet}
\begin{codesyntax}%
\tsmacro{PkgSet}{pack-name,keyval-list}
\end{codesyntax}
This will create a property list associated with \tsobj[marg]{pack-name}. \tsobj[marg]{keyval-list} might contain any set of keys, though, the functions below expect at least \tsobj[meta]{version} (for version checking) and \tsobj[meta]{name,version,date,description} (for \tsobj{\PkgDescription}).
\end{codedescribe}
\begin{tsremark}
  An error will be raised if calling it twice for the same \tsobj[marg]{pack-name}.
\end{tsremark}
For Example:
\begin{codestore}[demoB]
\PkgSet {pkginfo}
  { 
    name         = {pkginfo} ,
    prefix       = {pkginfo} ,
    date         = {2025/10/19},
    version      = {1.0} ,
    description  = {Collecting~ package's~ info~ in~ a~ regular~ way}
  }
\end{codestore}

\tscode*[pkginfo]{demoB}

\begin{codedescribe}{\PkgInfo}
\begin{codesyntax}%
\tsmacro{\PkgInfo}{pack-name,key}
\end{codesyntax}
This will retrieve \tsobj[marg]{key}'s value. If \tsobj[marg,sep=or]{pack-name,key} doesn't exist, this will expands to nothing.
\end{codedescribe}


\begin{codedescribe}{\PkgDescription}
\begin{codesyntax}%
\tsmacro{\PkgDescription}{pack-name}
\end{codesyntax}
These will typeset a small paragraph (for data validation) with following \tsobj[marg]{pack-name}'s info: \tsobj[meta]{name,version,date,description}
\end{codedescribe}
For example:
\begin{codestore}[demoC]
\PkgDescription{pkginfo}
\end{codestore}

\tsdemo[pkginfo]{demoC}

\begin{codedescribe}{\PkgRequired}
\begin{codesyntax}%
\tsmacro{\PkgRequired}{your-pack,pack-name,min-version}
\end{codesyntax}
These will verify if \tsobj[marg]{pack-name}'s \tsobj[marg]{version} (as stored with \tsobj{\PkgSet}) is at least \tsobj[marg]{min-version}. It expects \tsobj[marg]{version} in one of three formats \tsobj[keys,sep=or]{[v]digits[letters],[v]digits.digits[letters],[v]digits.digits.digits[letters]} (the \tsobj[key]{[v]}, if present, is ignored).
\end{codedescribe}
\begin{tsremark}
  An error will be raised if \tsobj{pack-name}'s info isn't defined, incorrect version format or \tsobj[marg]{min-version} isn't satisfied, in which case the error will note that \tsobj{your-pack} needs version \tsobj[marg]{min-version} of \tsobj[marg]{pack-name}.
\end{tsremark}



%% if needed
%\printbibliography

\end{document} 